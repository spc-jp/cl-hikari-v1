<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hikari Brand Note</title>
    <!-- ãƒ‡ã‚¶ã‚¤ãƒ³ç”¨ï¼šTailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Reactæœ¬ä½“ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- JSXå¤‰æ›ç”¨ï¼šBabel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¨ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ã®è¨­å®š -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        hikari: {
                            base: '#EAEFF3',
                            text: '#626262',
                            accent: '#C11E2D',
                            darkBase: '#1f2937', // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰èƒŒæ™¯
                            darkCard: '#374151', // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚«ãƒ¼ãƒ‰
                            darkText: '#f3f4f6'  // ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰æ–‡å­—
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'scale(0.95)' },
                            '100%': { opacity: '1', transform: 'scale(1)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb { background: #4b5563; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- ã‚¢ã‚¤ã‚³ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (Lucide Icons) ---
        const Icon = ({ children, className = "", size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Copy = (p) => <Icon {...p}><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></Icon>;
        const Check = (p) => <Icon {...p}><polyline points="20 6 9 17 4 12"/></Icon>;
        const RefreshCw = (p) => <Icon {...p}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></Icon>;
        const Calendar = (p) => <Icon {...p}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></Icon>;
        const Users = (p) => <Icon {...p}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></Icon>;
        const PenTool = (p) => <Icon {...p}><path d="m12 19 7-7 3 3-7 7-3-3z"/><path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/><path d="m2 2 7.586 7.586"/><circle cx="11" cy="11" r="2"/></Icon>;
        const Camera = (p) => <Icon {...p}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></Icon>;
        const ChevronDown = (p) => <Icon {...p}><path d="m6 9 6 6 6-6"/></Icon>;
        const Settings = (p) => <Icon {...p}><path d="M12.22 2h-.44a2 2 0 0 1-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.72l-.15.1a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73v.18a2 2 0 0 1 2 2h.44a2 2 0 0 1 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.72l.15-.1a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 1-2-2z"/><circle cx="12" cy="12" r="3"/></Icon>;
        const HelpCircle = (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><path d="M12 17h.01"/></Icon>;
        const X = (p) => <Icon {...p}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>;
        const RotateCcw = (p) => <Icon {...p}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 16"/><path d="M3 3v5h5"/></Icon>;
        const Moon = (p) => <Icon {...p}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></Icon>;
        const Sun = (p) => <Icon {...p}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></Icon>;
        const AlertTriangle = (p) => <Icon {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></Icon>;
        const Facebook = (p) => <Icon {...p}><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></Icon>;
        const Twitter = (p) => <Icon {...p}><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/></Icon>;
        const MessageCircle = (p) => <Icon {...p}><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></Icon>;
        const ImageIcon = (p) => <Icon {...p}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></Icon>;
        const ImagePlus = (p) => <Icon {...p}><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"/><line x1="16" x2="22" y1="5" y2="5"/><line x1="19" x2="19" y1="2" y2="8"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></Icon>;
        const Building = (p) => <Icon {...p}><rect x="4" y="2" width="16" height="20" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M8 10h.01"/><path d="M16 10h.01"/><path d="M8 14h.01"/><path d="M16 14h.01"/></Icon>;
        const Factory = (p) => <Icon {...p}><path d="M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M17 18h1"/><path d="M12 18h1"/><path d="M7 18h1"/></Icon>;
        const Link = (p) => <Icon {...p}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></Icon>;
        const Folder = (p) => <Icon {...p}><path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 2H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"/></Icon>;
        const ArrowLeft = (p) => <Icon {...p}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></Icon>;
        const FileText = (p) => <Icon {...p}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></Icon>;

        // --- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æœ¬ä½“ ---
        const HikariBrandNote = () => {
            // --- State ---
            const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth() + 1);
            const [category, setCategory] = useState('company');
            const [eventDetail, setEventDetail] = useState('');
            const [stakeholder, setStakeholder] = useState('general');
            const [generatedText, setGeneratedText] = useState({ fb: '', insta: '', x: '' });
            const [imageSuggestion, setImageSuggestion] = useState('');
            const [copiedState, setCopiedState] = useState({ fb: false, insta: false, x: false });
            
            // Tab State
            const [activeTab, setActiveTab] = useState('insta');
            
            // Image Selection State
            const [selectedImage, setSelectedImage] = useState(null);
            const [imgBrowserPath, setImgBrowserPath] = useState([]); 
            
            // Settings State
            const [isSettingsOpen, setIsSettingsOpen] = useState(false);
            const [isHelpOpen, setIsHelpOpen] = useState(false);
            const [isDarkMode, setIsDarkMode] = useState(false);
            const [signature, setSignature] = useState("å…‰è£½è–¬æ ªå¼ä¼šç¤¾\nå…¬å¼ã‚µã‚¤ãƒˆï¼šhttps://www.hikari-pharma.co.jp/");
            const [showGreeting, setShowGreeting] = useState(true);
            const [ngWordsStr, setNgWordsStr] = useState("çµ¶å¯¾,100%,No.1,å¿…ãšæ²»ã‚‹,ãƒã‚º,çˆ†ä¼¸ã³,æœ€å¼·,åœ§å€’çš„,å£²ä¸Šç›´çµ,é›†å®¢"); 
            const [ngWarnings, setNgWarnings] = useState([]);
            
            // Link Settings State
            const [customLinkUrl, setCustomLinkUrl] = useState("https://www.hikari-pharma.co.jp/");
            const [customLinkText, setCustomLinkText] = useState("ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼ˆ@hikari_pharma_officialï¼‰ã®ãƒªãƒ³ã‚¯ã¸");

            // Holiday Settings State
            const [holidaySettings, setHolidaySettings] = useState({
                hq: {
                    summer: { start: '', end: '' },
                    winter: { start: '', end: '' }
                },
                factory: {
                    summer: { start: '', end: '' },
                    winter: { start: '', end: '' }
                }
            });

            // Monthly Event Options for Dropdown
            const [monthlyEventOptions, setMonthlyEventOptions] = useState([]);

            // Placeholder Text State
            const [placeholderText, setPlaceholderText] = useState("");

            // Templates Data
            const templates = [
                { label: "é¸æŠã—ã¦æœ¬æ–‡ã«æŒ¿å…¥...", value: "" },
                { 
                    label: "A) RTUãƒ©ã‚¤ãƒ³ç«‹ã¡ä¸Šã’æº–å‚™", 
                    value: "ã€RTUãƒ©ã‚¤ãƒ³ç«‹ã¡ä¸Šã’æº–å‚™ã€‘\næ–°ã—ã„RTUï¼ˆReady-To-Useï¼‰è£½é€ ãƒ©ã‚¤ãƒ³ã®ç«‹ã¡ä¸Šã’æº–å‚™ãŒé€²ã‚“ã§ã„ã¾ã™ã€‚\n\nãªãœä»Šã€æ–°ãƒ©ã‚¤ãƒ³ãªã®ã‹ã€‚\nãã‚Œã¯ã€ã‚ˆã‚Šè¿…é€Ÿã‹ã¤å®‰å…¨ã«ã€å¿…è¦ãªåŒ»è–¬å“ã‚’åŒ»ç™‚ç¾å ´ã¸å±Šã‘ã‚‹ãŸã‚ã§ã™ã€‚\næœ€æ–°ã®ç„¡èŒå……å¡«æŠ€è¡“ã«ã‚ˆã‚Šã€æ±šæŸ“ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã€å“è³ªã¸ã®ä¿¡é ¼ã‚’ã•ã‚‰ã«é«˜ã‚ã¦ã„ãã¾ã™ã€‚\n\næ©Ÿæ¢°ã®éŸ³ãŒéŸ¿ãå‰ã®é™ã‹ãªå·¥å ´ã§ã€æœªæ¥ã¸ã®è²¬ä»»ã‚’å†ç¢ºèªã—ã¾ã—ãŸã€‚" 
                },
                { 
                    label: "B) è¨­å‚™æŠ•è³‡ã®èƒŒæ™¯ï¼ˆå®‰å¿ƒæŠ•è³‡ï¼‰", 
                    value: "ã€è¨­å‚™æŠ•è³‡ã®ãŠçŸ¥ã‚‰ã›ã€‘\nå·¥å ´ã®ç©ºèª¿ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æœ€æ–°ç‰ˆã¸ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã—ãŸã€‚\n\nã“ã‚Œã¯å˜ãªã‚‹è€æœ½åŒ–å¯¾ç­–ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\nåŒ»è–¬å“è£½é€ ã«ä¸å¯æ¬ ãªã€Œç©ºæ°—ã®è³ªã€ã‚’ã€ã‚ˆã‚Šå³æ ¼ã«ã€ã‚ˆã‚Šå®‰å®šã—ã¦ç®¡ç†ã™ã‚‹ãŸã‚ã®ã€Œå®‰å¿ƒã¸ã®æŠ•è³‡ã€ã§ã™ã€‚\n\nç›®ã«è¦‹ãˆãªã„ç©ºæ°—ã®æµã‚Œä¸€ã¤ã²ã¨ã¤ã«ã‚‚ã€æ‚£è€…æ§˜ã®å®‰å…¨ãŒé–¢ã‚ã£ã¦ã„ã¾ã™ã€‚\nå¦¥å”ã®ãªã„ç’°å¢ƒã¥ãã‚ŠãŒã€ç§ãŸã¡ã®èª‡ã‚Šã§ã™ã€‚" 
                },
                { 
                    label: "C) å“è³ªç¢ºèªãƒ»æ¤œæŸ»å·¥ç¨‹ã®è¦‹ç›´ã—", 
                    value: "ã€å“è³ªç®¡ç†ã®å¼·åŒ–ã€‘\næ¤œæŸ»å·¥ç¨‹ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä¸€éƒ¨è¦‹ç›´ã—ã¾ã—ãŸã€‚\n\næœ€æ–°ã®æ¤œæŸ»æ©Ÿå™¨å°å…¥ã«åŠ ãˆã€ç†Ÿç·´ã‚¹ã‚¿ãƒƒãƒ•ã«ã‚ˆã‚‹äºŒé‡ãƒã‚§ãƒƒã‚¯ä½“åˆ¶ã‚’å¼·åŒ–ã€‚\nãƒ’ãƒ¥ãƒ¼ãƒãƒ³ã‚¨ãƒ©ãƒ¼ã‚’æ¥µé™ã¾ã§æ¸›ã‚‰ã—ã€ã€Œç¢ºã‹ãªå“è³ªã€ã ã‘ã‚’é€ã‚Šå‡ºã™ãŸã‚ã®ä»•çµ„ã¿ã¥ãã‚Šã§ã™ã€‚\n\nã€Œç–‘ã‚ã—ãã¯æ­¢ã‚ã‚‹ã€ã¨ã„ã†å‹‡æ°—ãŒã€æ‚£è€…æ§˜ã®å®‰å¿ƒã«ã¤ãªãŒã‚‹ã¨ä¿¡ã˜ã¦ã„ã¾ã™ã€‚" 
                },
                { 
                    label: "D) å®‰å®šä¾›çµ¦ä½“åˆ¶ï¼ˆæ­¢ã‚ãªã„å·¥å¤«ï¼‰", 
                    value: "ã€å®‰å®šä¾›çµ¦ã¸ã®å–ã‚Šçµ„ã¿ã€‘\nç½å®³æ™‚ã«ã‚‚ä¾›çµ¦ã‚’æ­¢ã‚ãªã„ãŸã‚ã«ã€‚\nè‡ªå®¶ç™ºé›»è¨­å‚™ã®ç‚¹æ¤œã¨ã€å‚™è“„ç‡ƒæ–™ã®ç¢ºä¿ã‚’è¡Œã„ã¾ã—ãŸã€‚\n\nåŒ»è–¬å“ã¯ã€æ‚£è€…æ§˜ã®å‘½ã‚’ã¤ãªãã‚‚ã®ã€‚\nã©ã‚“ãªæ™‚ã§ã‚‚ã€å¿…è¦ãªè–¬ã‚’å¾…ã¤äººãŒã„ã‚‹é™ã‚Šã€ç§ãŸã¡ã¯ä½œã‚Šç¶šã‘ã¾ã™ã€‚\nå‚™ãˆã‚ã‚Œã°æ†‚ã„ãªã—ã€‚æ—¥ã€…ã®ç‚¹æ¤œãŒã€éå¸¸æ™‚ã®å‘½ç¶±ã§ã™ã€‚" 
                },
                { 
                    label: "E) äººæè‚²æˆï¼ˆæŠ€è¡“ç¶™æ‰¿ï¼‰", 
                    value: "ã€æŠ€è¡“ç¶™æ‰¿ã®ç¾å ´ã‹ã‚‰ã€‘\nãƒ™ãƒ†ãƒ©ãƒ³æŠ€è¡“è€…ã‹ã‚‰è‹¥æ‰‹ã¸ã€ç„¡èŒæ“ä½œã®æŠ€è¡“ç¶™æ‰¿ç ”ä¿®ã‚’è¡Œã„ã¾ã—ãŸã€‚\n\nãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«ã¯æ›¸ã‘ãªã„ã€æŒ‡å…ˆã®ã€Œæ„Ÿè¦šã€ã‚„ã€Œæ‰€ä½œã€ã€‚\nå“è³ªã¸ã®ã“ã ã‚ã‚Šã¯ã€äººã‹ã‚‰äººã¸ã€æ‰‹ã‹ã‚‰æ‰‹ã¸ã¨å—ã‘ç¶™ãŒã‚Œã¦ã„ãã¾ã™ã€‚\n\nçœŸå‰£ãªçœ¼å·®ã—ã§å­¦ã¶è‹¥æ‰‹ã®å§¿ã«ã€å…‰è£½è–¬ã®æœªæ¥ã‚’è¦‹ã¾ã—ãŸã€‚" 
                },
                { 
                    label: "F) é€æ˜æ€§ï¼ˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ»æƒ…å ±å…¬é–‹ï¼‰", 
                    value: "ã€ä¿¡é ¼ã®åœŸå°ã¥ãã‚Šã€‘\nå“è³ªç®¡ç†ã«é–¢ã™ã‚‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’æ›´æ–°ã—ã€ç¤¾å†…ã‚¤ãƒ³ãƒˆãƒ©ã§å…¬é–‹ã—ã¾ã—ãŸã€‚\n\nã€Œèª°ãŒæ‹…å½“ã—ã¦ã‚‚ã€åŒã˜é«˜å“è³ªã‚’å®ˆã‚Œã‚‹ã‚ˆã†ã«ã€ã€‚\nãƒ—ãƒ­ã‚»ã‚¹ã®é€æ˜åŒ–ã¯ã€çµ„ç¹”ã¨ã—ã¦ã®èª å®Ÿã•ã®è¨¼ã§ã™ã€‚\n\néš ã™ã“ã¨ãªãã€é–‹ã‹ã‚ŒãŸå§¿å‹¢ã§ã€çš†æ§˜ã‹ã‚‰ã®ä¿¡é ¼ã«ãŠå¿œãˆã—ã¦ã„ãã¾ã™ã€‚" 
                },
                { 
                    label: "G) Vision2030ï¼ˆæœªæ¥å®£è¨€ï¼‰", 
                    value: "ã€Vision2030ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€‘\n2030å¹´ã«å‘ã‘ãŸç¤¾å†…ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå§‹å‹•ã—ã¾ã—ãŸã€‚\n\nã€ŒåŒ»ç™‚ã®æœªæ¥ã‚’æ”¯ãˆã‚‹å…‰ã«ãªã‚‹ã€ã€‚\nã“ã®ãƒ“ã‚¸ãƒ§ãƒ³ã®ã‚‚ã¨ã€ä»Šæ—¥ã¯éƒ¨ç½²ã‚’è¶…ãˆãŸç†±ã„ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ãŒè¡Œã‚ã‚Œã¾ã—ãŸã€‚\n\n10å¹´å¾Œã®ç¬‘é¡”ã®ãŸã‚ã«ã€ç§ãŸã¡ã¯ä»Šæ—¥ã€ç¢ºã‹ãªä¸€æ­©ã‚’è¸ã¿å‡ºã—ã¾ã™ã€‚" 
                }
            ];

            // Closing Sentences
            const closingSentences = [
                "Vision2030ã¸å‘ã‘ã¦ã€ä»Šæ—¥ã‚‚åœŸå°ã‚’æ•´ãˆã¦ã„ã¾ã™ã€‚",
                "è¦‹ãˆãªã„ã¨ã“ã‚ã‹ã‚‰ã€ä¿¡é ¼ã‚’ç©ã¿é‡ã­ã¦ã„ã¾ã™ã€‚",
                "ã“ã‚Œã‹ã‚‰ã‚‚ã€å®‰å¿ƒã‚’å±Šã‘ã‚‹æº–å‚™ã‚’ç¶šã‘ã¾ã™ã€‚",
                "æœªæ¥ã®å½“ãŸã‚Šå‰ã‚’ã€ã„ã¾ã¤ãã£ã¦ã„ã¾ã™ã€‚"
            ];

            // --- Server Image Assets Data Structure ---
            const imageDatabase = {
                id: 'root',
                name: 'root',
                type: 'folder',
                children: [
                    {
                        id: 'hq',
                        name: 'æœ¬ç¤¾',
                        type: 'folder',
                        icon: <Building />,
                        children: [
                            {
                                id: 'hq_ext',
                                name: 'å¤–è¦³',
                                type: 'folder',
                                children: [
                                    { id: 'hq_ext_sunny', name: 'æœ¬ç¤¾ å¤–è¦³ (æ™´ã‚Œ)', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=HQ+Exterior+(Sunny)' },
                                    { id: 'hq_ext_night', name: 'æœ¬ç¤¾ å¤–è¦³ (å¤œæ™¯)', type: 'image', url: 'https://placehold.co/600x400/1f2937/EAEFF3?text=HQ+Exterior+(Night)' },
                                    { id: 'hq_ext_entrance', name: 'æ­£é¢ç„é–¢', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Main+Entrance' }
                                ]
                            },
                            {
                                id: 'hq_int',
                                name: 'å†…è¦³',
                                type: 'folder',
                                children: [
                                    { id: 'hq_int_lobby', name: 'ã‚¨ãƒ³ãƒˆãƒ©ãƒ³ã‚¹ãƒ›ãƒ¼ãƒ«', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Entrance+Hall' },
                                    { id: 'hq_int_office', name: 'ã‚ªãƒ•ã‚£ã‚¹é¢¨æ™¯', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Office+View' },
                                    { id: 'hq_int_meeting', name: 'ä¼šè­°å®¤', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Meeting+Room' }
                                ]
                            }
                        ]
                    },
                    {
                        id: 'factory',
                        name: 'å·¥å ´',
                        type: 'folder',
                        icon: <Factory />,
                        children: [
                            {
                                id: 'fac_ext',
                                name: 'å¤–è¦³',
                                type: 'folder',
                                children: [
                                    { id: 'fac_ext_main', name: 'å·¥å ´ å…¨æ™¯', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Factory+Full+View' },
                                    { id: 'fac_ext_gate', name: 'å·¥å ´ æ­£é–€', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Factory+Gate' }
                                ]
                            },
                            {
                                id: 'fac_int',
                                name: 'å†…è¦³',
                                type: 'folder',
                                children: [
                                    { id: 'fac_int_line', name: 'è£½é€ ãƒ©ã‚¤ãƒ³', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Production+Line' },
                                    { id: 'fac_int_lab', name: 'å“è³ªç®¡ç†å®¤', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=QC+Lab' },
                                    { id: 'fac_int_warehouse', name: 'ç‰©æµå€‰åº«', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/626262?text=Warehouse' }
                                ]
                            }
                        ]
                    },
                    {
                        id: 'other',
                        name: 'ãã®ä»–ç´ æ',
                        type: 'folder',
                        icon: <ImageIcon />,
                        children: [
                            { id: 'logo_color', name: 'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ­ã‚´ (ã‚«ãƒ©ãƒ¼)', type: 'image', url: 'https://placehold.co/600x400/EAEFF3/C11E2D?text=Hikari+Logo' },
                            { id: 'sky', name: 'é’ç©ºã‚¤ãƒ¡ãƒ¼ã‚¸', type: 'image', url: 'https://placehold.co/600x400/87CEEB/ffffff?text=Sky+Image' }
                        ]
                    }
                ]
            };

            // Helper to get current folder content based on path
            const getCurrentFolder = () => {
                let current = imageDatabase;
                for (const pathId of imgBrowserPath) {
                    if (current.children) {
                        current = current.children.find(child => child.id === pathId);
                    }
                }
                return current;
            };

            const navigateToFolder = (folderId) => {
                setImgBrowserPath([...imgBrowserPath, folderId]);
            };

            const navigateUp = () => {
                setImgBrowserPath(imgBrowserPath.slice(0, -1));
            };


            // Public Holidays
            const publicHolidays = {
                1: ["å…ƒæ—¥", "æˆäººã®æ—¥"],
                2: ["å»ºå›½è¨˜å¿µã®æ—¥", "å¤©çš‡èª•ç”Ÿæ—¥"],
                3: ["æ˜¥åˆ†ã®æ—¥"],
                4: ["æ˜­å’Œã®æ—¥"],
                5: ["æ†²æ³•è¨˜å¿µæ—¥", "ã¿ã©ã‚Šã®æ—¥", "ã“ã©ã‚‚ã®æ—¥"],
                6: [],
                7: ["æµ·ã®æ—¥"],
                8: ["å±±ã®æ—¥"],
                9: ["æ•¬è€ã®æ—¥", "ç§‹åˆ†ã®æ—¥"],
                10: ["ã‚¹ãƒãƒ¼ãƒ„ã®æ—¥"],
                11: ["æ–‡åŒ–ã®æ—¥", "å‹¤åŠ´æ„Ÿè¬ã®æ—¥"],
                12: []
            };

            // Branding Messages
            const brandingMessages = {
                general: {
                    short: "ã¾ã£ã™ãã€ã‚„ã•ã—ãã€åŒ»ç™‚ã¨äººã‚’ã¤ãªãã€‚",
                    long: "ç§ãŸã¡å…‰è£½è–¬ã¯ã€å‰µæ¥­ä»¥æ¥å¤‰ã‚ã‚‰ã¬æƒ³ã„ã§ã€ä¸€ã¤ã²ã¨ã¤ã®åŒ»è–¬å“ã¨å‘ãåˆã£ã¦ã„ã¾ã™ã€‚\næŠ€è¡“ã®é€²æ­©ã¨å…±ã«ã€æ±ºã—ã¦å¤‰ã‚ã‚‰ãªã„ã€Œã‚„ã•ã—ã•ã€ã‚’ã€ã™ã¹ã¦ã®æ‚£è€…æ§˜ã¸ã€‚\næœªæ¥ã®å¥ã‚„ã‹ãªæ¯æ—¥ã®ãŸã‚ã«ã€ç§ãŸã¡ã¯ä»Šæ—¥ã‚‚æ­©ã¿ç¶šã‘ã¾ã™ã€‚"
                },
                patient: {
                    short: "çŸ¥ã£ã¦å®‰å¿ƒã€å±Šã‘ãŸã„ã®ã¯â€œã‚„ã•ã—ã•â€ã§ã™ã€‚",
                    long: "ç—…æ°—ã¨å‘ãåˆã†æ™‚é–“ã€ãµã¨ã—ãŸç¬é–“ã«æ„Ÿã˜ã‚‹ä¸å®‰ã€‚\nç§ãŸã¡ã¯ã€ãã‚“ãªå¿ƒã«ãã£ã¨å¯„ã‚Šæ·»ãˆã‚‹å­˜åœ¨ã§ã‚ã‚ŠãŸã„ã¨é¡˜ã£ã¦ã„ã¾ã™ã€‚\nã€ŒçŸ¥ã£ã¦å®‰å¿ƒã€ã¨æ€ã£ã¦ã„ãŸã ã‘ã‚‹æƒ…å ±ã‚’ã€ã¾ã”ã“ã‚ã‚’è¾¼ã‚ã¦ãŠå±Šã‘ã—ã¾ã™ã€‚"
                },
                medical: {
                    short: "ç¾å ´ã«â€œå®‰å¿ƒâ€ã‚’ã€‚ç¢ºã‹ãªæƒ…å ±ã‚’ã€ã™ãæ‰‹å…ƒã«ã€‚",
                    long: "ä¸€åˆ†ä¸€ç§’ã‚’äº‰ã†åŒ»ç™‚ã®ç¾å ´ã§ã€è¿·ã„ãªãä¿¡é ¼ã§ãã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã§ã‚ã‚‹ã“ã¨ã€‚\nç¢ºã‹ãªã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ã¨ã€ä½¿ã„ã‚„ã™ã•ã‚’è¿½æ±‚ã—ãŸæƒ…å ±æä¾›ã§ã€\nå…ˆç”Ÿæ–¹ã¨ã€ãã®å…ˆã«ã„ã‚‹æ‚£è€…æ§˜ã®ç¬‘é¡”ã‚’æ”¯ãˆç¶šã‘ã¾ã™ã€‚"
                },
                recruit: {
                    short: "â€œåŒ»ç™‚ã®ãƒ’ã‚«ãƒªâ€ã‚’ã€æœªæ¥ã¸ç´¡ãã‚ãªãŸã¸ã€‚",
                    long: "å®Ÿé¨“å®¤ã®å°ã•ãªæ˜ã‹ã‚Šã¯ã€ã‚„ãŒã¦èª°ã‹ã®å¸Œæœ›ã®å…‰ã«ãªã‚‹ã€‚\nã‚ãªãŸã®æƒ…ç†±ã¨å„ªã—ã•ãŒã€æ˜æ—¥ã®åŒ»ç™‚ã‚’å¤‰ãˆã‚‹åŠ›ã«ãªã‚Šã¾ã™ã€‚\nç§ãŸã¡ã¨ä¸€ç·’ã«ã€ã¾ã è¦‹ã¬ã€Œãƒ’ã‚«ãƒªè¼ããƒŸãƒ©ã‚¤ã€ã‚’å‰µã‚Šã«è¡Œãã¾ã›ã‚“ã‹ï¼Ÿ"
                },
                partner: {
                    short: "â€œã¤ãã‚‹åŠ›â€ã‚’ã€åŒ»è–¬å“é–‹ç™ºã«æ´»ã‹ã—ã¾ã›ã‚“ã‹ï¼Ÿ",
                    long: "ç¢ºã‹ãªæŠ€è¡“åŠ›ã¨ã€æŸ”è»Ÿãªå¯¾å¿œåŠ›ã§ã€åŒ»è–¬å“é–‹ç™ºã®èª²é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚\nå…±ã«ç›®æŒ‡ã™ã®ã¯ã€ä¸–ç•Œä¸­ã®äººã€…ã®å¥åº·ã¸ã®è²¢çŒ®ã€‚\nä¿¡é ¼ã§ãã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã—ã¦ã€è²´ç¤¾ã®ãƒ“ã‚¸ãƒã‚¹ã‚’å¼·åŠ›ã«ã‚µãƒãƒ¼ãƒˆã„ãŸã—ã¾ã™ã€‚"
                },
                csr: {
                    short: "åœ°åŸŸã¨å…±ã«ã€å¥ã‚„ã‹ãªæœªæ¥ã‚’è‚²ã‚€ã€‚",
                    long: "ç§ãŸã¡ã¯ã€è–¬ã‚’ä½œã‚‹ã ã‘ã§ãªãã€å¥ã‚„ã‹ãªç¤¾ä¼šã‚’ä½œã‚‹ä¼æ¥­ã§ã‚ã‚ŠãŸã„ã€‚\nç’°å¢ƒã¸ã®é…æ…®ã€åœ°åŸŸã¨ã®é€£æºã‚’é€šã˜ã¦ã€æŒç¶šå¯èƒ½ãªæœªæ¥ã¸ã®è²¬ä»»ã‚’æœãŸã—ã¾ã™ã€‚\næ¬¡ä¸–ä»£ã«èª‡ã‚Œã‚‹ç¤¾ä¼šã‚’ã€ã“ã“ã‹ã‚‰ã€‚"
                }
            };

            const replyPatterns = {
                general: [
                    { label: "æ„Ÿè¬", text: "æ¸©ã‹ã„ã‚³ãƒ¡ãƒ³ãƒˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ãƒãƒ¼ãƒ ä¸€åŒã€åŠ±ã¿ã«ãªã‚Šã¾ã™ã€‚" },
                    { label: "å…±æ„Ÿ", text: "ãã®ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ãŸã ã‘ã¦å¬‰ã—ã„ã§ã™ã€‚ã“ã‚Œã‹ã‚‰ã‚‚ã€Œã‚„ã•ã—ã•ã€ã‚’å¤§åˆ‡ã«ã—ã¦ã„ãã¾ã™ã€‚" },
                    { label: "æ¡ˆå†…", text: "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚è©³ç´°ã«ã¤ãã¾ã—ã¦ã¯ã€ãœã²å…¬å¼ã‚µã‚¤ãƒˆã‚‚ã”è¦§ãã ã•ã„ã€‚" }
                ],
                patient: [
                    { label: "å¯„ã‚Šæ·»ã„", text: "ã‚³ãƒ¡ãƒ³ãƒˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚çš†æ§˜ã®å®‰å¿ƒã«ã¤ãªãŒã‚‹ã‚ˆã†ã€å¼•ãç¶šãæƒ…å ±ã‚’ç™ºä¿¡ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚" },
                    { label: "æ°—é£ã„", text: "å­£ç¯€ã®å¤‰ã‚ã‚Šç›®ã§ã™ã®ã§ã€ã©ã†ãã”è‡ªæ„›ãã ã•ã„ã€‚ã„ã¤ã‚‚ã”è¦§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" },
                    { label: "å•ã„åˆã‚ã›", text: "ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€å…¬å¼ã‚µã‚¤ãƒˆã®ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã‚ˆã‚ŠãŠæ°—è»½ã«ã”é€£çµ¡ãã ã•ã„ã€‚" }
                ],
                medical: [
                    { label: "å¾¡ç¤¼", text: "ã„ã¤ã‚‚åŒ»ç™‚ã®æœ€å‰ç·šã§ã®ã”å°½åŠ›ã€å¿ƒã‚ˆã‚Šæ•¬æ„ã‚’è¡¨ã—ã¾ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" },
                    { label: "ã‚µãƒãƒ¼ãƒˆ", text: "è²´é‡ãªã”æ„è¦‹ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ä»Šå¾Œã®æƒ…å ±æä¾›ã®æ”¹å–„ã«å½¹ç«‹ã¦ã¦ã¾ã„ã‚Šã¾ã™ã€‚" },
                    { label: "é€£æº", text: "ç¾å ´ã®å£°ã‚’ã„ãŸã ãæ„Ÿè¬ã„ãŸã—ã¾ã™ã€‚ä¿¡é ¼ã•ã‚Œã‚‹ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã§ã‚ã‚Šç¶šã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã€åŠªã‚ã¦ã¾ã„ã‚Šã¾ã™ã€‚" }
                ],
                recruit: [
                    { label: "æ­“è¿", text: "ã”èˆˆå‘³ã‚’æŒã£ã¦ã„ãŸã ãå¬‰ã—ã„ã§ã™ï¼ä¸€ç·’ã«æœªæ¥ã‚’å‰µã‚Œã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ã„ã¾ã™ã€‚" },
                    { label: "å¿œæ´", text: "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å°±è·æ´»å‹•ã€å¿œæ´ã—ã¦ã„ã¾ã™ï¼ä½•ã‹ã‚ã‚Œã°èª¬æ˜ä¼šãªã©ã§ã”è³ªå•ãã ã•ã„ã€‚" },
                    { label: "èª˜å°", text: "è©³ç´°ãªå‹Ÿé›†è¦é …ã¯ã€æ¡ç”¨ã‚µã‚¤ãƒˆã«ã¦å…¬é–‹ã—ã¦ãŠã‚Šã¾ã™ã€‚ãœã²ãƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¦ãã ã•ã„ã€‚" }
                ],
                partner: [
                    { label: "æ„Ÿè¬", text: "ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚" },
                    { label: "å”æ¥­", text: "å…±ã«æ–°ã—ã„ä¾¡å€¤ã‚’å‰µé€ ã§ãã‚‹ã“ã¨ã‚’æ¥½ã—ã¿ã«ã—ã¦ãŠã‚Šã¾ã™ã€‚ä»Šå¾Œã¨ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚" },
                    { label: "ä¿¡é ¼", text: "æ¸©ã‹ã„ãŠè¨€è‘‰ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ç¢ºã‹ãªæŠ€è¡“ã§ãŠå¿œãˆã§ãã‚‹ã‚ˆã†ã€é‚é€²ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚" }
                ],
                csr: [
                    { label: "æ”¯æ´", text: "æ¸©ã‹ã„ã”æ”¯æ´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚åœ°åŸŸç¤¾ä¼šã®ä¸€å“¡ã¨ã—ã¦ã€ã“ã‚Œã‹ã‚‰ã‚‚è²¢çŒ®ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚" },
                    { label: "å…±æ„Ÿ", text: "æ´»å‹•ã¸ã®å…±æ„Ÿã€å¤§å¤‰å¬‰ã—ãæ€ã„ã¾ã™ã€‚æŒç¶šå¯èƒ½ãªç¤¾ä¼šã‚’ç›®æŒ‡ã—ã€å…±ã«æ­©ã‚“ã§ã„ãã¾ã—ã‚‡ã†ã€‚" },
                    { label: "å ±å‘Š", text: "ã”è¦§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚æ´»å‹•ã®è©³ç´°ã¯ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£ãƒ¬ãƒãƒ¼ãƒˆã§ã‚‚ã”å ±å‘Šã—ã¦ãŠã‚Šã¾ã™ã€‚" }
                ]
            };

            const imageSuggestionData = {
                company: "ã€æ¨å¥¨ç”»åƒã€‘\nã‚ªãƒ•ã‚£ã‚¹ã®çª“ã‹ã‚‰å·®ã—è¾¼ã‚€æŸ”ã‚‰ã‹ãªè‡ªç„¶å…‰ã‚’å…¥ã‚ŒãŸã€ç¤¾å“¡ã®è‡ªç„¶ãªè¡¨æƒ…ã€‚\nã¾ãŸã¯ã€å­£ç¯€ã®èŠ±ã‚„ç©ºã®å†™çœŸã‚’èƒŒæ™¯ã«ã€ãƒ­ã‚´ã‚’é…ç½®ã—ãŸæ¸…æ½”æ„Ÿã®ã‚ã‚‹ç”»åƒã€‚",
                academic: "ã€æ¨å¥¨ç”»åƒã€‘\nå­¦ä¼šä¼šå ´ã®çœ‹æ¿ã‚’èƒŒæ™¯ã«ã€å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼ãŒå……å®Ÿã—ãŸè¡¨æƒ…ã§ä¸¦ã‚“ã§ã„ã‚‹é›†åˆå†™çœŸã€‚\nçœŸå‰£ã«ãƒã‚¹ã‚¿ãƒ¼ç™ºè¡¨ã‚’èã„ã¦ã„ã‚‹å¾Œã‚å§¿ãªã©ã€Œç†±æ„ã€ãŒä¼ã‚ã‚‹æ§‹å›³ã€‚",
                csr: "ã€æ¨å¥¨ç”»åƒã€‘\nåœ°åŸŸæ¸…æƒã‚„ã‚¤ãƒ™ãƒ³ãƒˆæ´»å‹•ä¸­ã®ã€ç¤¾å“¡ã¨åœ°åŸŸã®æ–¹ã¨ã®ãµã‚Œã‚ã„ã®ç¬é–“ã€‚\nã€Œæ‰‹å…ƒã€ã‚„ã€Œç¬‘é¡”ã€ã«ã‚¯ãƒ­ãƒ¼ã‚ºã‚¢ãƒƒãƒ—ã—ã€äººã®æ¸©ã‹ã•ã‚’å¼·èª¿ã—ãŸå†™çœŸã€‚",
                recruit: "ã€æ¨å¥¨ç”»åƒã€‘\nå…ˆè¼©ç¤¾å“¡ãŒå¾Œè¼©ã«å„ªã—ãæ•™ãˆã¦ã„ã‚‹ã‚·ãƒ¼ãƒ³ã‚„ã€ç¤¾å“¡é£Ÿå ‚ã§ã®ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ãŸã‚ªãƒ•ã‚·ãƒ§ãƒƒãƒˆã€‚\nã€Œã“ã®ä¼šç¤¾ã§åƒãã‚¤ãƒ¡ãƒ¼ã‚¸ã€ãŒæ¹§ãã‚ˆã†ãªã€æ˜ã‚‹ãè¦ªã—ã¿ã‚„ã™ã„é›°å›²æ°—ã§ã€‚",
                product: "ã€æ¨å¥¨ç”»åƒã€‘\nå·¥å ´å†…ã®æ©Ÿæ¢°ã®ãƒ¡ã‚¿ãƒªãƒƒã‚¯ãªè³ªæ„Ÿã¨ã€å³ã—ããƒã‚§ãƒƒã‚¯ã™ã‚‹æ‹…å½“è€…ã®çœŸå‰£ãªçœ¼å·®ã—ã€‚\nã€Œå“è³ªã¸ã®ã“ã ã‚ã‚Šã€ãŒä¼ã‚ã‚‹ã€å°‘ã—ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆå¼·ã‚ã®æ´—ç·´ã•ã‚ŒãŸå†™çœŸã€‚",
                vision2030: "ã€æ¨å¥¨ç”»åƒã€‘\næœªæ¥ã‚’è¦‹æ®ãˆã‚‹ç¤¾å“¡ã®æ¨ªé¡”ã‚„ã€æ–°ã—ã„å»ºè¨­è¨ˆç”»ã®æ¨¡å‹ã€ã¾ãŸã¯ã€Œå…‰ã€ã‚’ãƒ¢ãƒãƒ¼ãƒ•ã«ã—ãŸæŠ½è±¡çš„ã§å¸Œæœ›ã‚’æ„Ÿã˜ã•ã›ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚",
                rtu_line: "ã€æ¨å¥¨ç”»åƒã€‘\næ–°ãƒ©ã‚¤ãƒ³ã®ã‚¯ãƒªãƒ¼ãƒ³ãƒ«ãƒ¼ãƒ è¶Šã—ã«è¦‹ãˆã‚‹æœ€æ–°æ©Ÿå™¨ã€ã¾ãŸã¯ç„¡èŒè¡£ã‚’ç€ãŸæ‹…å½“è€…ãŒç‚¹æ¤œã—ã¦ã„ã‚‹çœŸå‰£ãªå§¿ã€‚ã€Œæ¸…æ½”æ„Ÿã€ã¨ã€Œæœ€æ–°æŠ€è¡“ã€ã‚’å¼·èª¿ã€‚"
            };

            const coreHashtags = ["#å…‰è£½è–¬", "#HikariBrandNote", "#Vision2030", "#åŒ»ç™‚ã¨äººã‚’ã¤ãªã"];
            
            const variableHashtagsData = {
                company: ["#ä¼æ¥­æ–‡åŒ–", "#ç¤¾å†…é¢¨æ™¯", "#è£½è–¬ä¼šç¤¾"],
                academic: ["#å­¦ä¼šæƒ…å ±", "#åŒ»ç™‚ãƒ‹ãƒ¥ãƒ¼ã‚¹", "#ç ”ç©¶é–‹ç™º"],
                csr: ["#ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£", "#åœ°åŸŸè²¢çŒ®", "#å¥åº·çµŒå–¶"],
                recruit: ["#æ¡ç”¨", "#å°±æ´»", "#åƒãäºº"],
                product: ["#å“è³ªç®¡ç†", "#å®‰å®šä¾›çµ¦", "#ã‚‚ã®ã¥ãã‚Š"],
                vision2030: ["#æœªæ¥ã¸ã®æŒ‘æˆ¦", "#ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³", "#é•·æœŸãƒ“ã‚¸ãƒ§ãƒ³"],
                rtu_line: ["#è¨­å‚™æŠ•è³‡", "#æ–°æŠ€è¡“", "#å®‰å…¨å¯¾ç­–", "#RTU"]
            };

            // Category Placeholders
            const categoryPlaceholders = {
                company: "ä¾‹ï¼šå‰µæ¥­ã€‡å‘¨å¹´ã‚’è¿ãˆã€è¨˜å¿µå¼å…¸ã‚’è¡Œã„ã¾ã—ãŸã€‚\nä¾‹ï¼šç¤¾å†…ãƒ¬ã‚¯ãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æ·±ã‚ã¾ã—ãŸã€‚",
                academic: "ä¾‹ï¼šç¬¬20å› æ—¥æœ¬åŒ»å­¦ä¼šç·ä¼šã«å‚åŠ ã—ã€æ–°è–¬ã®ç ”ç©¶æˆæœã‚’ç™ºè¡¨ã—ã¾ã—ãŸã€‚\nä¾‹ï¼šã€‡ã€‡å­¦ä¼šã«ã¦ã€å½“ç¤¾ã®ç ”ç©¶å“¡ãŒå„ªç§€è³ã‚’å—è³ã—ã¾ã—ãŸã€‚",
                csr: "ä¾‹ï¼šåœ°åŸŸã®æ¸…æƒæ´»å‹•ã«å‚åŠ ã—ã€è¿‘éš£ä½æ°‘ã®æ–¹ã€…ã¨äº¤æµã—ã¾ã—ãŸã€‚\nä¾‹ï¼šCO2å‰Šæ¸›ã«å‘ã‘ãŸæ–°ã—ã„å–ã‚Šçµ„ã¿ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚",
                recruit: "ä¾‹ï¼š202Xå¹´åº¦ã®æ–°å…¥ç¤¾å“¡ã‚’è¿ãˆã€å…¥ç¤¾å¼ã‚’åŸ·ã‚Šè¡Œã„ã¾ã—ãŸã€‚\nä¾‹ï¼šå…ˆè¼©ç¤¾å“¡ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼å‹•ç”»ã‚’å…¬é–‹ã—ã¾ã—ãŸã€‚",
                product: "ä¾‹ï¼šä¸»åŠ›è£½å“ã€Œã€‡ã€‡ã€ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ã—ã€è¦–èªæ€§ã‚’å‘ä¸Šã•ã›ã¾ã—ãŸã€‚\nä¾‹ï¼šæ–°å·¥å ´ã§ã®è£½é€ ãƒ©ã‚¤ãƒ³ãŒç¨¼åƒã‚’é–‹å§‹ã—ã€å®‰å®šä¾›çµ¦ä½“åˆ¶ã‚’å¼·åŒ–ã—ã¾ã—ãŸã€‚",
                vision2030: "2030å¹´ã«å‘ã‘ãŸæ–¹é‡ã‚„æ”¹å–„ã®æ–¹å‘æ€§ã‚’ã€ã‚„ã•ã—ãè¨€è‘‰ã«ã—ã¾ã™ã€‚\nä¾‹ï¼šå…¨ç¤¾ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚­ãƒƒã‚¯ã‚ªãƒ•ã€æœªæ¥ã«å‘ã‘ãŸå®£è¨€ãªã©ã€‚",
                rtu_line: "å®‰å®šä¾›çµ¦ã¨å“è³ªå‘ä¸Šã«ã¤ãªãŒã‚‹å–ã‚Šçµ„ã¿ã‚’ã€èª å®Ÿã«ä¼ãˆã¾ã™ã€‚\nä¾‹ï¼šæ–°ãƒ©ã‚¤ãƒ³ã®æ¬å…¥ã€ç„¡èŒãƒ†ã‚¹ãƒˆã®å®Ÿæ–½ãªã©ã€‚"
            };

            // Update placeholder when category changes
            useEffect(() => {
                setPlaceholderText(categoryPlaceholders[category] || "è©³ç´°å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            }, [category]);

            // Calculate Monthly Events
            useEffect(() => {
                let options = [];
                const holidays = publicHolidays[selectedMonth] || [];
                holidays.forEach(h => options.push({ label: `ç¥æ—¥: ${h}`, value: `${h}ã®ãŠçŸ¥ã‚‰ã›` }));

                const fmt = (d) => {
                    if(!d) return "";
                    const date = new Date(d);
                    return `${date.getMonth()+1}/${date.getDate()}`;
                };

                const checkHoliday = (setting, label) => {
                    if (setting.start) {
                        const startDate = new Date(setting.start);
                        if (startDate.getMonth() + 1 === selectedMonth) {
                            const range = `${fmt(setting.start)}ã€œ${fmt(setting.end)}`;
                            options.push({ label: `${label} (${range})`, value: `${label} (${range})` });
                        }
                    }
                };

                checkHoliday(holidaySettings.hq.summer, "æœ¬ç¤¾å¤å­£ä¼‘æš‡");
                checkHoliday(holidaySettings.hq.winter, "æœ¬ç¤¾å†¬å­£ä¼‘æš‡");
                checkHoliday(holidaySettings.factory.summer, "å·¥å ´å¤å­£ä¼‘æš‡");
                checkHoliday(holidaySettings.factory.winter, "å·¥å ´å†¬å­£ä¼‘æš‡");

                setMonthlyEventOptions(options);

            }, [selectedMonth, holidaySettings]);

            const handleEventSelect = (e) => {
                const val = e.target.value;
                if (!val) return;
                setEventDetail(prev => {
                    if (prev.includes(val)) return prev;
                    return prev + (prev ? "\n" : "") + val;
                });
            };

            // Template Selection Handler
            const handleTemplateSelect = (e) => {
                const val = e.target.value;
                if (!val) return;
                if (eventDetail && !window.confirm("å…¥åŠ›æ¸ˆã¿ã®å†…å®¹ãŒä¸Šæ›¸ãã•ã‚Œã¾ã™ãŒã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) {
                    return;
                }
                setEventDetail(val);
            };

            useEffect(() => {
                if (!eventDetail) {
                    setNgWarnings([]);
                    return;
                }
                const words = ngWordsStr.split(',').map(w => w.trim()).filter(w => w);
                const detected = words.filter(word => eventDetail.includes(word));
                setNgWarnings(detected);
            }, [eventDetail, ngWordsStr]);

            useEffect(() => {
                if (isDarkMode) {
                    document.documentElement.classList.add('dark');
                    document.body.classList.remove('bg-[#EAEFF3]');
                    document.body.classList.add('bg-hikari-darkBase');
                } else {
                    document.documentElement.classList.remove('dark');
                    document.body.classList.add('bg-[#EAEFF3]');
                    document.body.classList.remove('bg-hikari-darkBase');
                }
            }, [isDarkMode]);

            const generateContent = () => {
                const variableTags = variableHashtagsData[category] || ["#è£½è–¬", "#å¥åº·", "#æœªæ¥"];
                const allHashtags = [...coreHashtags, ...variableTags].join(' '); 
                
                const monthStr = `${selectedMonth}æœˆ`;
                const intro = showGreeting ? getSeasonalIntro(monthStr) : "";
                
                // Branding Block
                const brandingBlock = brandingMessages[stakeholder].long;
                const shortBranding = brandingMessages[stakeholder].short;

                // Random Closing Sentence
                const closing = closingSentences[Math.floor(Math.random() * closingSentences.length)];

                const topicHeader = category === 'academic' ? 'å­¦ä¼šãƒ»ç ”ç©¶ãƒ‹ãƒ¥ãƒ¼ã‚¹' : 
                                    category === 'vision2030' ? 'Vision2030' :
                                    category === 'rtu_line' ? 'æ–°ãƒ©ã‚¤ãƒ³æƒ…å ±' : 'ä»Šæœˆã®ãƒˆãƒ”ãƒƒã‚¯ã‚¹';
                                    
                const mainBody = eventDetail 
                ? `\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nã€${topicHeader}ã€‘\n${eventDetail}\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\n` 
                : '';

                // FB Text
                const fbText = `${intro ? intro + "\n\n" : ""}${mainBody}\n${closing}\n\n${brandingBlock}\n\nç§ãŸã¡å…‰è£½è–¬ã¯ã€ã“ã‚Œã‹ã‚‰ã‚‚åŒ»ç™‚ã®æœªæ¥ã‚’ç…§ã‚‰ã—ç¶šã‘ã¾ã™ã€‚\n\n----------------------------\n${signature}\n----------------------------\n\n${allHashtags}`;

                // Insta Text
                const instaFooter = `\nç§ãŸã¡ã®æ—¥ã€…ã®å–ã‚Šçµ„ã¿ã‚„ã€æƒ³ã„ã‚’ç™ºä¿¡ã—ã¦ã„ã¾ã™ã€‚\nãœã²ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ã€å…‰è£½è–¬ã®ã€Œä»Šã€ã«è§¦ã‚Œã¦ãã ã•ã„ã€‚\n\nğŸ”— ${customLinkText}`;
                const instaText = `${intro ? intro + "\n\n" : ""}${eventDetail ? `${eventDetail}\n\n${closing}\n\n` : ''}..\n\n${brandingBlock}\n${instaFooter}\n\n${allHashtags}`;

                // X Text
                const xText = `ã€${monthStr}ã®ãŠçŸ¥ã‚‰ã›ã€‘\n\n${shortBranding}\n\n${eventDetail}\n\n${closing}\n\n${showGreeting ? "å­£ç¯€ã®å¤‰ã‚ã‚Šç›®ã€çš†æ§˜ã‚‚ã”è‡ªæ„›ãã ã•ã„ã€‚\n" : ""}#å…‰è£½è–¬ #Vision2030`; 

                setGeneratedText({ fb: fbText, insta: instaText, x: xText });
                setImageSuggestion(imageSuggestionData[category] || "å†…å®¹ã«åˆã‚ã›ãŸæ¸…æ½”æ„Ÿã®ã‚ã‚‹å†™çœŸ");
            };

            const getSeasonalIntro = (month) => {
                const greetings = {
                1: "æ–°ã—ã„å¹´ã®å¹•é–‹ã‘ã€‚\nå‡›ã¨ã—ãŸç©ºæ°—ã®ä¸­ã€ç§ãŸã¡ã‚‚æ–°ãŸãªæ±ºæ„ã¨å…±ã«ã‚¹ã‚¿ãƒ¼ãƒˆã‚’åˆ‡ã‚Šã¾ã—ãŸã€‚",
                2: "å¯’ã•ã®ä¸­ã«ã‚‚ã€å°‘ã—ãšã¤æ˜¥ã®è¶³éŸ³ãŒèã“ãˆã¦ãã‚‹å­£ç¯€ã€‚\næ¢…ã®è•¾ãŒã»ã“ã‚ã¶ã‚ˆã†ã«ã€å¸Œæœ›ã¸ã®æº–å‚™ã‚’é€²ã‚ã¦ã„ã¾ã™ã€‚",
                3: "æ—¥å·®ã—ãŒæŸ”ã‚‰ã‹ããªã‚Šã€å¿ƒã‚‚å¼¾ã‚€æ˜¥ã®è¨ªã‚Œã€‚\næ–°ã—ã„å‡ºä¼šã„ã¨æŒ‘æˆ¦ã®å­£ç¯€ãŒã‚„ã£ã¦ãã¾ã—ãŸã€‚",
                4: "æ¡œèˆã†ç¾ã—ã„å­£ç¯€ã€‚\næ–°ã—ã„ä»²é–“ã‚’è¿ãˆã€å…‰è£½è–¬ã‚‚ãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãªé¢¨ã¨å…±ã«æ­©ã¿å‡ºã—ã¾ã™ã€‚",
                5: "æ–°ç·‘ãŒã¾ã¶ã—ã„å­£ç¯€ã€‚\nè‹¥è‘‰ã®ã‚ˆã†ã«åŠ›å¼·ãã€ç§ãŸã¡ã‚‚æˆé•·ã‚’ç¶šã‘ã¦ã¾ã„ã‚Šã¾ã™ã€‚",
                6: "é›¨ã®éŸ³ã«ç´«é™½èŠ±ãŒæ˜ ãˆã‚‹å­£ç¯€ã€‚\nä¸€é›¨ã”ã¨ã«æ·±ã¾ã‚‹ç·‘ã®ã‚ˆã†ã«ã€ç§ãŸã¡ã®çµ†ã‚‚æ·±ã‚ã¦ã„ãã¾ã™ã€‚",
                7: "å¤ç©ºãŒåºƒãŒã‚‹å­£ç¯€ã€‚\nå¤ªé™½ã®å…‰ã«è² ã‘ãªã„ãã‚‰ã„ã®ç†±æ„ã§ã€åŒ»ç™‚ã®ç¾å ´ã‚’æ”¯ãˆã¾ã™ã€‚",
                8: "è‰æ™‚é›¨ãŒéŸ¿ãå¤æœ¬ç•ªã€‚\næš‘ã•ã«è² ã‘ãšã€å®‰å®šä¾›çµ¦ã¨ã„ã†ä½¿å‘½ã‚’èƒ¸ã«æ—¥ã€…é‚é€²ã—ã¦ã„ã¾ã™ã€‚",
                9: "å°‘ã—ãšã¤ç§‹ã®æ°—é…ã‚’æ„Ÿã˜ã‚‹ä»Šæ—¥ã“ã®é ƒã€‚\nå®Ÿã‚Šã®ç§‹ã«å‘ã‘ã€ã“ã‚Œã¾ã§ã®æˆæœã‚’å½¢ã«ã™ã‚‹æ™‚æœŸã§ã™ã€‚",
                10: "æœ¨ã€…ãŒè‰²ã¥ãå§‹ã‚ã‚‹ç¾ã—ã„å­£ç¯€ã€‚\næ·±ã¾ã‚‹ç§‹ã¨å…±ã«ã€ç§ãŸã¡ã®ç ”ç©¶ã‚‚ã‚ˆã‚Šæ·±ãã€ã‚ˆã‚Šæœ¬è³ªã¸ã€‚",
                11: "è‚Œå¯’ã•ã‚’æ„Ÿã˜ã‚‹å­£ç¯€ã€‚\nçš†æ§˜ã®å¥åº·ã‚’é¡˜ã†æ°—æŒã¡ãŒã€ã‚ˆã‚Šä¸€å±¤å¼·ããªã‚‹æ™‚æœŸã§ã™ã€‚",
                12: "ä¸€å¹´ã®ç· ã‚ããã‚Šã®æœˆã€‚\næ„Ÿè¬ã®æ°—æŒã¡ã‚’è¾¼ã‚ã¦ã€ä»Šå¹´ä¸€å¹´ã‚’æŒ¯ã‚Šè¿”ã‚Šã€æœªæ¥ã¸æƒ³ã„ã‚’é¦³ã›ã¾ã™ã€‚"
                };
                return greetings[selectedMonth] || `${month}ã‚’è¿ãˆã€æ°—æŒã¡ã‚’æ–°ãŸã«æ¥­å‹™ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚`;
            };

            const handleCopy = (text) => {
                const showSuccess = () => {
                    setCopiedState(prev => ({ ...prev, [activeTab]: true }));
                    setTimeout(() => setCopiedState(prev => ({ ...prev, [activeTab]: false })), 2000);
                };

                const copyToClipboardFallback = (str) => {
                    const el = document.createElement('textarea');
                    el.value = str;
                    el.setAttribute('readonly', '');
                    el.style.position = 'absolute';
                    el.style.left = '-9999px';
                    document.body.appendChild(el);
                    
                    const selected = 
                        document.getSelection().rangeCount > 0 
                            ? document.getSelection().getRangeAt(0) 
                            : false;
                    el.select();
                    
                    let successful = false;
                    try {
                        successful = document.execCommand('copy');
                    } catch (err) {
                        console.error('Fallback copy failed', err);
                    }
                    
                    document.body.removeChild(el);
                    if (selected) {
                        document.getSelection().removeAllRanges();
                        document.getSelection().addRange(selected);
                    }
                    return successful;
                };

                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(text)
                        .then(showSuccess)
                        .catch(err => {
                            console.warn("Clipboard API failed, using fallback", err);
                            if(copyToClipboardFallback(text)) {
                                showSuccess();
                            } else {
                                alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
                            }
                        });
                } else {
                    if(copyToClipboardFallback(text)) {
                        showSuccess();
                    } else {
                        alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
                    }
                }
            };

            const handleReset = () => {
                if(window.confirm("å…¥åŠ›å†…å®¹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")) {
                    setEventDetail("");
                    setCategory("company");
                    setSelectedMonth(new Date().getMonth() + 1);
                    setStakeholder("general");
                    setSelectedImage(null);
                    setImgBrowserPath([]);
                }
            };

            const handleHolidayChange = (location, type, key, value) => {
                setHolidaySettings(prev => ({
                    ...prev,
                    [location]: {
                        ...prev[location],
                        [type]: {
                            ...prev[location][type],
                            [key]: value
                        }
                    }
                }));
            };

            useEffect(() => {
                generateContent();
            }, [selectedMonth, category, eventDetail, stakeholder, signature, showGreeting, customLinkText]);

            const renderImageSelection = () => {
                const currentFolder = getCurrentFolder();
                
                return (
                    <div className="bg-hikari-base dark:bg-gray-800 p-4 border-t border-slate-200 dark:border-gray-700 animate-fade-in">
                        
                        {/* Suggestion Text */}
                        <div className="mb-4 bg-white dark:bg-gray-700 border-2 border-dashed border-slate-300 dark:border-gray-500 rounded-lg p-3 flex items-start gap-3">
                            <div className="bg-red-50 dark:bg-red-900/50 text-hikari-accent p-2 rounded-full shrink-0">
                                <ImageIcon size={20} />
                            </div>
                            <div>
                                <h3 className="font-bold text-sm mb-1 text-gray-700 dark:text-gray-200">ãŠã™ã™ã‚ã®ç”»åƒæ§‹æˆ</h3>
                                <p className="text-xs leading-relaxed opacity-80 whitespace-pre-wrap">
                                    {imageSuggestion}
                                </p>
                            </div>
                        </div>

                        {/* Image Browser */}
                        <div className="bg-white dark:bg-gray-800 rounded-lg border border-slate-200 dark:border-gray-600 overflow-hidden">
                            <div className="bg-gray-100 dark:bg-gray-700 p-2 flex items-center gap-2 border-b border-gray-200 dark:border-gray-600">
                                {imgBrowserPath.length > 0 ? (
                                    <button 
                                        onClick={navigateUp}
                                        className="p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"
                                    >
                                        <ArrowLeft size={16} />
                                    </button>
                                ) : (
                                    <span className="p-1"><ImagePlus size={16} className="text-hikari-accent"/></span>
                                )}
                                <span className="font-bold text-sm text-gray-700 dark:text-gray-200">
                                    {currentFolder.name === 'root' ? 'ã‚µãƒ¼ãƒãƒ¼ç”»åƒä¸€è¦§' : currentFolder.name}
                                </span>
                            </div>
                            
                            <div className="p-3">
                                {currentFolder.children && currentFolder.children.length > 0 ? (
                                    <div className="grid grid-cols-2 sm:grid-cols-3 gap-2">
                                        {currentFolder.children.map((item) => (
                                            item.type === 'folder' ? (
                                                // Folder Item
                                                <button
                                                    key={item.id}
                                                    onClick={() => navigateToFolder(item.id)}
                                                    className="flex flex-col items-center justify-center p-4 bg-blue-50 dark:bg-gray-700 hover:bg-blue-100 dark:hover:bg-gray-600 rounded-lg transition-colors gap-2 h-24"
                                                >
                                                    <div className="text-blue-500 dark:text-blue-300">
                                                        {item.icon || <Folder size={32} />}
                                                    </div>
                                                    <span className="text-xs font-bold text-gray-700 dark:text-gray-200">{item.name}</span>
                                                </button>
                                            ) : (
                                                // Image Item
                                                <button
                                                    key={item.id}
                                                    onClick={() => setSelectedImage(item)}
                                                    className={`relative rounded-lg overflow-hidden border-2 transition-all aspect-video group
                                                        ${selectedImage?.id === item.id 
                                                            ? 'border-hikari-accent ring-2 ring-hikari-accent/30' 
                                                            : 'border-transparent hover:border-gray-300'}`}
                                                >
                                                    <img src={item.url} alt={item.name} className="w-full h-full object-cover" />
                                                    <div className="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                                        <span className="text-[10px] text-white font-bold bg-black/50 px-1 rounded">{item.name}</span>
                                                    </div>
                                                    {selectedImage?.id === item.id && (
                                                        <div className="absolute top-1 right-1 bg-hikari-accent text-white rounded-full p-0.5">
                                                            <Check size={10} />
                                                        </div>
                                                    )}
                                                </button>
                                            )
                                        ))}
                                    </div>
                                ) : (
                                    <div className="text-center py-4 text-xs opacity-50">ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“</div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            const renderReplyExamples = () => {
                const patterns = replyPatterns[stakeholder] || replyPatterns['general'];
                return (
                    <div className="mb-4 p-4 bg-gray-50 dark:bg-gray-800/50 animate-fade-in border-b border-slate-200 dark:border-gray-700">
                        <h3 className="font-bold text-sm mb-3 flex items-center gap-2 text-hikari-text dark:text-gray-300">
                            <MessageCircle size={16} className="text-hikari-accent" />
                            ã‚³ãƒ¡ãƒ³ãƒˆã¸ã®è¿”ä¿¡ä¾‹ 
                            <span className="text-[10px] font-normal opacity-70">ï¼ˆã‚¯ãƒªãƒƒã‚¯ã§ã‚³ãƒ”ãƒ¼ï¼‰</span>
                        </h3>
                        <div className="space-y-2">
                            {patterns.map((pattern, idx) => (
                                <button 
                                    key={idx}
                                    onClick={() => handleCopy(pattern.text)}
                                    className="w-full text-left p-3 bg-white dark:bg-gray-700 rounded border border-slate-200 dark:border-gray-600 hover:border-hikari-accent dark:hover:border-hikari-accent group transition-all"
                                >
                                    <div className="flex justify-between items-center mb-1">
                                        <span className="text-[10px] font-bold bg-slate-100 dark:bg-gray-600 text-slate-600 dark:text-gray-300 px-2 py-0.5 rounded">
                                            {pattern.label}
                                        </span>
                                        <span className="text-[10px] text-hikari-accent opacity-0 group-hover:opacity-100 transition-opacity">
                                            ã‚³ãƒ”ãƒ¼ã™ã‚‹
                                        </span>
                                    </div>
                                    <p className="text-xs text-gray-700 dark:text-gray-200 leading-relaxed">
                                        {pattern.text}
                                    </p>
                                </button>
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div className={`min-h-screen font-sans pb-20 transition-colors duration-300 ${isDarkMode ? 'text-hikari-darkText' : 'text-hikari-text'}`}>
                
                <div className="sticky top-0 z-10 bg-white dark:bg-hikari-darkCard border-b border-hikari-accent/20 shadow-sm px-4 py-3 flex items-center justify-between md:hidden">
                    <div className="flex items-center gap-2">
                        {/* Logo with placeholder fallback */}
                        <img src="https://placehold.co/200x80/ffffff/C11E2D?text=Hikari+Pharma" alt="å…‰è£½è–¬ãƒ­ã‚´" className="h-8 w-auto object-contain" onError={(e) => e.target.style.display = 'none'} />
                        <h1 className="font-bold text-sm">Hikari Brand Note</h1>
                    </div>
                    <div className="flex gap-2">
                        <button onClick={() => setIsHelpOpen(true)} className="p-2 text-hikari-text dark:text-gray-200"><HelpCircle size={20}/></button>
                        <button onClick={() => setIsSettingsOpen(true)} className="p-2 text-hikari-text dark:text-gray-200"><Settings size={20}/></button>
                    </div>
                </div>

                <div className="max-w-4xl mx-auto p-4 md:p-8">
                    
                    <header className="hidden md:flex mb-8 border-b-4 border-hikari-accent pb-4 bg-white dark:bg-hikari-darkCard p-6 rounded-t-xl shadow-sm items-center justify-between">
                        <div className="flex items-center gap-4">
                            <div className="h-16 w-auto flex items-center">
                                {/* Logo with placeholder fallback */}
                                <img src="https://placehold.co/200x80/ffffff/C11E2D?text=Hikari+Pharma" alt="å…‰è£½è–¬ãƒ­ã‚´" className="h-full w-auto object-contain" onError={(e) => e.target.style.display = 'none'} />
                            </div>
                            <div className="border-l-2 border-slate-200 dark:border-gray-600 pl-4">
                                <h1 className="text-2xl font-bold">Hikari Brand Note</h1>
                                <p className="font-bold text-sm text-hikari-accent mt-1">æ—¥å¸¸ã‹ã‚‰ã€ä¿¡é ¼ã‚’ç©ã¿é‡ã­ã‚‹SNSç™ºä¿¡</p>
                                <p className="opacity-70 text-xs mt-0.5">Vision2030ã®æ–¹å‘æ€§ã¨ã€ç¾å ´ã®å–ã‚Šçµ„ã¿ã‚’â€œã¤ãªãè¨€è‘‰â€ã«æ•´ãˆã¾ã™</p>
                            </div>
                        </div>
                        <div className="flex gap-3">
                            <button 
                                onClick={() => setIsHelpOpen(true)}
                                className="flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-50 dark:bg-gray-700 text-blue-700 dark:text-blue-200 hover:bg-blue-100 transition-colors"
                            >
                                <HelpCircle size={18} />
                                <span>ä½¿ã„æ–¹</span>
                            </button>
                            <button 
                                onClick={() => setIsSettingsOpen(true)}
                                className="flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 transition-colors"
                            >
                                <Settings size={18} />
                                <span>è¨­å®š</span>
                            </button>
                        </div>
                    </header>

                    <div className="grid grid-cols-1 gap-6">
                    
                    {/* Controls Section */}
                    <div className="space-y-4">
                        
                        <section className="bg-white dark:bg-hikari-darkCard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-gray-700 transition-colors">
                            <h2 className="flex items-center gap-2 font-bold text-base mb-3 text-hikari-accent">
                                <Calendar size={20} />
                                æŠ•ç¨¿æ™‚æœŸ
                            </h2>
                            <div className="flex flex-col md:flex-row gap-4 items-start md:items-center">
                                <div className="relative w-full md:w-1/3">
                                    <select 
                                    value={selectedMonth}
                                    onChange={(e) => setSelectedMonth(Number(e.target.value))}
                                    className="w-full appearance-none p-3 pl-4 pr-10 bg-hikari-base dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-lg text-lg font-medium focus:ring-2 focus:ring-hikari-accent outline-none cursor-pointer"
                                    >
                                    {[...Array(12)].map((_, i) => (
                                        <option key={i} value={i + 1}>{i + 1}æœˆ</option>
                                    ))}
                                    </select>
                                    <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-60">
                                    <ChevronDown size={20} />
                                    </div>
                                </div>
                                
                                <div className="flex-1 w-full">
                                     <div className="relative">
                                        <select 
                                            onChange={handleEventSelect}
                                            className="w-full appearance-none p-3 pl-4 pr-10 bg-blue-50 dark:bg-gray-800 border border-blue-200 dark:border-gray-600 rounded-lg text-sm font-medium text-blue-800 dark:text-blue-200 focus:ring-2 focus:ring-blue-500 outline-none cursor-pointer"
                                            value=""
                                        >
                                            <option value="">è¡Œäº‹ã‚’é¸æŠã—ã¦æœ¬æ–‡ã«è¿½åŠ </option>
                                            {monthlyEventOptions.length > 0 ? (
                                                monthlyEventOptions.map((opt, idx) => (
                                                    <option key={idx} value={opt.value}>{opt.label}</option>
                                                ))
                                            ) : (
                                                <option disabled>ã“ã®æœˆã®è¡Œäº‹è¨­å®šã¯ã‚ã‚Šã¾ã›ã‚“</option>
                                            )}
                                        </select>
                                        <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-blue-500 dark:text-blue-300">
                                            <ChevronDown size={16} />
                                        </div>
                                     </div>
                                </div>
                            </div>
                        </section>

                        <section className="bg-white dark:bg-hikari-darkCard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-gray-700 transition-colors">
                            <h2 className="flex items-center gap-2 font-bold text-base mb-3 text-hikari-accent">
                                <Users size={20} />
                                ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ (ãƒ–ãƒ©ãƒ³ãƒ‰æˆ¦ç•¥)
                            </h2>
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-2">
                                {[
                                { id: 'general', label: 'ä¸€èˆ¬ãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰å…¨ä½“', desc: 'ã¾ã£ã™ãã€ã‚„ã•ã—ã' },
                                { id: 'patient', label: 'æ‚£è€…æ§˜ãƒ»ã”å®¶æ—', desc: 'å®‰å¿ƒã¨ã‚„ã•ã—ã•' },
                                { id: 'medical', label: 'åŒ»ç™‚é–¢ä¿‚è€…', desc: 'ä¿¡é ¼ã¨ç¢ºã‹ãªæƒ…å ±' },
                                { id: 'recruit', label: 'æ¡ç”¨å€™è£œè€…', desc: 'æœªæ¥ã¸ã®ãƒ’ã‚«ãƒª' },
                                { id: 'partner', label: 'ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ä¼æ¥­', desc: 'CDMOãƒ»ç¢ºä¿¡' },
                                { id: 'csr', label: 'åœ°åŸŸãƒ»ç¤¾ä¼š (CSR)', desc: 'æŒç¶šå¯èƒ½ãªæœªæ¥ãƒ»è²¢çŒ®' },
                                ].map((item) => (
                                <button
                                    key={item.id}
                                    onClick={() => setStakeholder(item.id)}
                                    className={`text-left p-3 rounded-lg border transition-all ${
                                    stakeholder === item.id
                                        ? 'border-hikari-accent bg-red-50 dark:bg-red-900/30 ring-1 ring-hikari-accent'
                                        : 'border-slate-200 dark:border-gray-600 hover:border-hikari-accent/50'
                                    }`}
                                >
                                    <div className="font-bold text-sm">{item.label}</div>
                                    <div className="text-xs opacity-70">{item.desc}</div>
                                </button>
                                ))}
                            </div>
                        </section>

                        <section className="bg-white dark:bg-hikari-darkCard p-5 rounded-xl shadow-sm border border-slate-200 dark:border-gray-700 transition-colors">
                            <div className="flex justify-between items-center mb-3">
                                <h2 className="flex items-center gap-2 font-bold text-base text-hikari-accent">
                                    <PenTool size={20} />
                                    æŠ•ç¨¿å†…å®¹
                                </h2>
                                <button 
                                    onClick={handleReset}
                                    className="flex items-center gap-1 text-xs text-gray-500 hover:text-red-500 transition-colors"
                                >
                                    <RotateCcw size={14}/>
                                    ãƒªã‚»ãƒƒãƒˆ
                                </button>
                            </div>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-bold mb-2">æŠ•ç¨¿ãƒ†ãƒ¼ãƒï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼‰</label>
                                    <div className="relative">
                                    <select 
                                        value={category} 
                                        onChange={(e) => setCategory(e.target.value)}
                                        className="w-full appearance-none p-3 bg-hikari-base dark:bg-gray-700 border border-slate-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-hikari-accent outline-none"
                                    >
                                        <option value="company">ä¼šç¤¾è¡Œäº‹ãƒ»ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
                                        <option value="academic">å­¦ä¼šãƒ»ç ”ç©¶ãƒ‹ãƒ¥ãƒ¼ã‚¹</option>
                                        <option value="csr">ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£ãƒ»åœ°åŸŸè²¢çŒ®</option>
                                        <option value="recruit">æ¡ç”¨ãƒ»ç¤¾å“¡ç´¹ä»‹</option>
                                        <option value="product">è£½å“ãƒ»å·¥å ´ï¼ˆCDMOï¼‰</option>
                                        <option value="vision2030">Vision2030ï¼ˆæœªæ¥ã¸ã®å–ã‚Šçµ„ã¿ï¼‰</option>
                                        <option value="rtu_line">RTUãƒ©ã‚¤ãƒ³ï¼ˆç«‹ã¡ä¸Šã’ãƒ»è¨­å‚™æŠ•è³‡ï¼‰</option>
                                    </select>
                                    <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-60">
                                        <ChevronDown size={18} />
                                    </div>
                                    </div>
                                </div>

                                {/* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠæ©Ÿèƒ½ï¼ˆè¿½åŠ ï¼‰ */}
                                <div className="bg-orange-50 dark:bg-orange-900/20 p-3 rounded-lg border border-orange-100 dark:border-orange-800/30">
                                    <label className="block text-xs font-bold mb-2 text-orange-800 dark:text-orange-200 flex items-center gap-1">
                                        <FileText size={14} /> ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ä¸‹æ›¸ãã‚’é¸ã¶
                                    </label>
                                    <div className="relative">
                                        <select 
                                            onChange={handleTemplateSelect}
                                            className="w-full appearance-none p-2 pl-3 pr-8 bg-white dark:bg-gray-800 border border-orange-200 dark:border-gray-600 rounded text-sm focus:ring-2 focus:ring-orange-400 outline-none cursor-pointer"
                                            defaultValue=""
                                        >
                                            {templates.map((tpl, idx) => (
                                                <option key={idx} value={tpl.value}>{tpl.label}</option>
                                            ))}
                                        </select>
                                        <div className="absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none opacity-60 text-orange-800 dark:text-orange-200">
                                            <ChevronDown size={16} />
                                        </div>
                                    </div>
                                    <p className="text-[10px] text-orange-600 dark:text-orange-300 mt-1">â€»é¸æŠã™ã‚‹ã¨å…¥åŠ›æ¬„ã®å†…å®¹ãŒä¸Šæ›¸ãã•ã‚Œã¾ã™</p>
                                </div>

                                <div>
                                    <label className="block text-sm font-bold mb-2">
                                    è©³ç´°å†…å®¹ 
                                    <span className="ml-2 text-xs font-normal opacity-60">â€»å…·ä½“çš„ãªè¡Œäº‹åã‚„å‡ºæ¥äº‹ã‚’å…¥åŠ›</span>
                                    </label>
                                    <textarea
                                        value={eventDetail}
                                        onChange={(e) => setEventDetail(e.target.value)}
                                        placeholder={placeholderText}
                                        className="w-full p-3 border bg-white dark:bg-gray-800 border-slate-300 dark:border-gray-600 rounded-lg h-40 text-sm focus:ring-2 focus:ring-hikari-accent outline-none resize-none"
                                    />
                                    {ngWarnings.length > 0 && (
                                        <div className="mt-2 text-red-500 text-xs flex items-center gap-1 font-bold animate-pulse">
                                            <AlertTriangle size={14} />
                                            <span>NGãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™: {ngWarnings.join(", ")}</span>
                                        </div>
                                    )}
                                </div>
                            </div>

                            <div className="mt-4 pt-4 border-t border-slate-100 dark:border-gray-700">
                                <button 
                                onClick={generateContent}
                                className="w-full py-3 bg-hikari-accent text-white rounded-lg flex items-center justify-center gap-2 hover:bg-[#a01825] transition-colors font-bold shadow-md active:transform active:scale-95"
                                >
                                <RefreshCw size={18} />
                                å†…å®¹ã‚’æ›´æ–°ã™ã‚‹
                                </button>
                                <div className="text-center mt-2 flex flex-col gap-1 text-[10px] text-gray-500 dark:text-gray-400">
                                    <span>å£²ã‚Šè¾¼ã‚€æŠ•ç¨¿ã§ã¯ãªãã€ä¿¡é ¼ã‚’è‚²ã¦ã‚‹æŠ•ç¨¿ã‚’ã€‚</span>
                                    <span>ä¸€å›ã®æŠ•ç¨¿ã‚ˆã‚Šã€ç©ã¿é‡ã­ãŒãƒ–ãƒ©ãƒ³ãƒ‰ã«ãªã‚Šã¾ã™ã€‚</span>
                                </div>
                            </div>
                        </section>

                    </div>

                    <div className="space-y-6">
                        <div className="flex items-center gap-2 mb-2">
                        <h2 className="font-bold text-xl">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
                        <span className="text-xs bg-hikari-base dark:bg-gray-700 px-2 py-1 rounded-full border border-slate-200 dark:border-gray-600">ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨</span>
                        </div>
                        
                        <div className="flex bg-white dark:bg-hikari-darkCard rounded-t-xl overflow-hidden border-b border-gray-200 dark:border-gray-700">
                             <button 
                                onClick={() => setActiveTab('insta')}
                                className={`flex-1 py-3 text-xs md:text-sm font-bold flex items-center justify-center gap-1 md:gap-2 transition-colors
                                ${activeTab === 'insta' 
                                    ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' 
                                    : 'bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700'}`}
                             >
                                <Camera size={16} /> Instagram
                             </button>
                             <button 
                                onClick={() => setActiveTab('fb')}
                                className={`flex-1 py-3 text-xs md:text-sm font-bold flex items-center justify-center gap-1 md:gap-2 transition-colors
                                ${activeTab === 'fb' 
                                    ? 'bg-[#1877F2] text-white' 
                                    : 'bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700'}`}
                             >
                                <Facebook size={16} /> Facebook
                             </button>
                             <button 
                                onClick={() => setActiveTab('x')}
                                className={`flex-1 py-3 text-xs md:text-sm font-bold flex items-center justify-center gap-1 md:gap-2 transition-colors
                                ${activeTab === 'x' 
                                    ? 'bg-black text-white' 
                                    : 'bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700'}`}
                             >
                                <Twitter size={16} /> X (Twitter)
                             </button>
                             <button 
                                onClick={() => setActiveTab('reply')}
                                className={`flex-1 py-3 text-xs md:text-sm font-bold flex items-center justify-center gap-1 md:gap-2 transition-colors
                                ${activeTab === 'reply' 
                                    ? 'bg-green-600 text-white' 
                                    : 'bg-gray-100 dark:bg-gray-800 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700'}`}
                             >
                                <MessageCircle size={16} /> è¿”ä¿¡ä¾‹
                             </button>
                        </div>

                        <div className="border border-t-0 border-slate-200 dark:border-gray-700 rounded-b-xl overflow-hidden shadow-sm bg-white dark:bg-hikari-darkCard min-h-[300px]">
                            
                            {/* Copy Bar (Only for Post tabs) */}
                            {activeTab !== 'reply' && (
                                <div className="bg-gray-50 dark:bg-gray-900/50 px-4 py-3 flex justify-between items-center border-b border-gray-100 dark:border-gray-700">
                                    <span className="font-bold text-sm text-gray-500 dark:text-gray-400">
                                        {activeTab === 'insta' && 'Instagram æŠ•ç¨¿ç”¨'}
                                        {activeTab === 'fb' && 'Facebook æŠ•ç¨¿ç”¨'}
                                        {activeTab === 'x' && 'X (æ—§Twitter) æŠ•ç¨¿ç”¨'}
                                    </span>
                                    <button 
                                    onClick={() => handleCopy(generatedText[activeTab])}
                                    className={`flex items-center gap-1 text-xs px-3 py-1.5 rounded-full transition-colors font-bold text-white shadow-sm
                                        ${activeTab === 'insta' ? 'bg-pink-500 hover:bg-pink-600' : 
                                        activeTab === 'fb' ? 'bg-blue-600 hover:bg-blue-700' : 
                                        'bg-gray-800 hover:bg-black'}`}
                                    >
                                    {copiedState[activeTab] ? <Check size={14} /> : <Copy size={14} />}
                                    {copiedState[activeTab] ? 'å®Œäº†' : 'ã‚³ãƒ”ãƒ¼'}
                                    </button>
                                </div>
                            )}

                            {activeTab === 'insta' && (
                                <div className="p-4 animate-fade-in">
                                    <div className="flex flex-col gap-4 mb-4">
                                        <div className="w-full bg-white dark:bg-gray-800 p-4 rounded border border-slate-100 dark:border-gray-600 whitespace-pre-wrap text-sm leading-relaxed">
                                            {generatedText.insta}
                                        </div>
                                        {selectedImage && (
                                            <div className="w-full max-w-sm mx-auto aspect-square bg-slate-100 dark:bg-gray-700 rounded-lg overflow-hidden border border-slate-200 dark:border-gray-600">
                                                <img src={selectedImage.url} alt="Preview" className="w-full h-full object-cover" />
                                            </div>
                                        )}
                                    </div>
                                </div>
                            )}

                            {activeTab === 'fb' && (
                                <div className="p-4 animate-fade-in">
                                    <div className="bg-hikari-base dark:bg-gray-800 p-4 rounded border border-slate-200 dark:border-gray-600 whitespace-pre-wrap text-sm leading-relaxed mb-4">
                                        {generatedText.fb}
                                    </div>
                                    {selectedImage && (
                                        <div className="mb-4 rounded-lg overflow-hidden border border-slate-200 dark:border-gray-600">
                                            <img src={selectedImage.url} alt="FB Preview" className="w-full h-48 object-cover" />
                                        </div>
                                    )}
                                </div>
                            )}

                            {activeTab === 'x' && (
                                <div className="p-4 animate-fade-in">
                                    <div className="bg-hikari-base dark:bg-gray-800 p-4 rounded border border-slate-200 dark:border-gray-600 whitespace-pre-wrap text-sm leading-relaxed mb-2">
                                        {generatedText.x}
                                    </div>
                                    <div className="mt-2 mb-4 text-right text-xs opacity-60">
                                        {generatedText.x.length} æ–‡å­—
                                    </div>
                                    {selectedImage && (
                                        <div className="mb-4 rounded-xl overflow-hidden border border-slate-200 dark:border-gray-600">
                                            <img src={selectedImage.url} alt="X Preview" className="w-full h-48 object-cover" />
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* Reply Tab Content */}
                            {activeTab === 'reply' && (
                                <div className="animate-fade-in">
                                    <div className="bg-green-50 dark:bg-green-900/20 px-4 py-3 border-b border-green-100 dark:border-green-800/30 flex items-center gap-2">
                                        <MessageCircle size={18} className="text-green-600 dark:text-green-400" />
                                        <span className="font-bold text-sm text-green-800 dark:text-green-200">ã‚³ãƒ¡ãƒ³ãƒˆã¸ã®è¿”ä¿¡ä¾‹</span>
                                    </div>
                                    {renderReplyExamples()}
                                </div>
                            )}

                            {/* Image Selection Area (Show for all tabs) */}
                            {renderImageSelection()}

                        </div>
                    </div>
                    </div>
                </div>

                {isHelpOpen && (
                    <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                        <div className="bg-white dark:bg-hikari-darkCard w-full max-w-md rounded-2xl shadow-xl overflow-hidden animate-fade-in">
                            <div className="p-5 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center">
                                <h3 className="font-bold text-lg flex items-center gap-2">
                                    <HelpCircle className="text-hikari-accent" />
                                    ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰
                                </h3>
                                <button onClick={() => setIsHelpOpen(false)} className="text-gray-400 hover:text-gray-600"><X size={24}/></button>
                            </div>
                            <div className="p-6 space-y-4">
                                <div className="text-sm opacity-80 mb-4">
                                    ã€ç›®çš„ã€‘<br/>
                                    Hikari Brand Note ã¯ã€æŠ•ç¨¿å‰ã«ã€Œã“ã®å†…å®¹ã¯å…‰è£½è–¬ã®ä¿¡é ¼ã‚’è‚²ã¦ã¦ã„ã‚‹ã‹ã€ã‚’ä¸€åº¦ç«‹ã¡æ­¢ã¾ã£ã¦ç¢ºèªã™ã‚‹ãŸã‚ã®ã‚¢ãƒ—ãƒªã§ã™ã€‚
                                </div>
                                <div className="space-y-3">
                                    <div className="flex items-start gap-3">
                                        <div className="bg-blue-100 text-blue-600 w-8 h-8 rounded-full flex items-center justify-center font-bold shrink-0">1</div>
                                        <div>
                                            <p className="font-bold text-sm">ç™ºä¿¡ã—ãŸã„å†…å®¹ã‚’å…¥åŠ›ãƒ»é¸æŠã—ã¾ã™</p>
                                        </div>
                                    </div>
                                    <div className="flex items-start gap-3">
                                        <div className="bg-blue-100 text-blue-600 w-8 h-8 rounded-full flex items-center justify-center font-bold shrink-0">2</div>
                                        <div>
                                            <p className="font-bold text-sm">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ´»ç”¨ã—ã€ãƒˆãƒ¼ãƒ³ã‚’çµ±ä¸€ã—ã¾ã™</p>
                                        </div>
                                    </div>
                                    <div className="flex items-start gap-3">
                                        <div className="bg-blue-100 text-blue-600 w-8 h-8 rounded-full flex items-center justify-center font-bold shrink-0">3</div>
                                        <div>
                                            <p className="font-bold text-sm">Vision2030ã«ã¤ãªãŒã‚‹ã€Œæœªæ¥ã®è¨€è‘‰ã€ã‚’æ·»ãˆã¾ã™</p>
                                        </div>
                                    </div>
                                    <div className="flex items-start gap-3">
                                        <div className="bg-blue-100 text-blue-600 w-8 h-8 rounded-full flex items-center justify-center font-bold shrink-0">4</div>
                                        <div>
                                            <p className="font-bold text-sm">ãã®ã¾ã¾SNSæŠ•ç¨¿æ–‡ã¨ã—ã¦æ´»ç”¨ã—ã¾ã™</p>
                                        </div>
                                    </div>
                                </div>
                                <div className="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 text-xs opacity-70">
                                    <p className="font-bold mb-1">ã€æŠ•ç¨¿æ–‡ã®ç›®çš„ã€‘</p>
                                    <ul className="list-disc list-inside space-y-1">
                                        <li>å£²ã‚Šè¾¼ã‚€ãŸã‚ã§ã¯ãªãã€ä¿¡é ¼ã‚’ç©ã¿é‡ã­ã‚‹ãŸã‚</li>
                                        <li>æ´¾æ‰‹ã•ã‚ˆã‚Šã‚‚ã€æ—¥å¸¸ã®èª å®Ÿã•</li>
                                        <li>ä¸€å›ã®æŠ•ç¨¿ã§ã¯ãªãã€ç¶™ç¶šã«ã‚ˆã‚‹ãƒ–ãƒ©ãƒ³ãƒ‰å½¢æˆ</li>
                                    </ul>
                                </div>
                            </div>
                            <div className="p-4 bg-gray-50 dark:bg-gray-800 text-center">
                                <button onClick={() => setIsHelpOpen(false)} className="w-full py-2 bg-hikari-accent text-white rounded-lg font-bold">ç†è§£ã—ã¾ã—ãŸï¼</button>
                            </div>
                        </div>
                    </div>
                )}

                {isSettingsOpen && (
                    <div className="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
                        <div className="bg-white dark:bg-hikari-darkCard w-full max-w-lg rounded-2xl shadow-xl overflow-hidden flex flex-col max-h-[90vh]">
                            <div className="p-5 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center">
                                <h3 className="font-bold text-lg flex items-center gap-2">
                                    <Settings className="text-gray-500" />
                                    è¨­å®šãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
                                </h3>
                                <button onClick={() => setIsSettingsOpen(false)} className="text-gray-400 hover:text-gray-600"><X size={24}/></button>
                            </div>
                            
                            <div className="p-6 space-y-6 overflow-y-auto">
                                
                                <div className="flex justify-between items-center pb-4 border-b border-gray-100 dark:border-gray-700">
                                    <div className="flex items-center gap-2">
                                        {isDarkMode ? <Moon size={20} className="text-yellow-400"/> : <Sun size={20} className="text-orange-400"/>}
                                        <span className="font-bold text-sm">ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</span>
                                    </div>
                                    <button 
                                        onClick={() => setIsDarkMode(!isDarkMode)}
                                        className={`w-12 h-6 rounded-full p-1 transition-colors ${isDarkMode ? 'bg-blue-600' : 'bg-gray-300'}`}
                                    >
                                        <div className={`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${isDarkMode ? 'translate-x-6' : 'translate-x-0'}`} />
                                    </button>
                                </div>

                                <div className="flex justify-between items-center pb-4 border-b border-gray-100 dark:border-gray-700">
                                    <div>
                                        <p className="font-bold text-sm">å­£ç¯€ã®æŒ¨æ‹¶æ–‡</p>
                                        <p className="text-xs opacity-60">è‡ªå‹•æŒ¿å…¥ã•ã‚Œã‚‹æ™‚å€™ã®æŒ¨æ‹¶ã‚’ON/OFFã—ã¾ã™</p>
                                    </div>
                                    <button 
                                        onClick={() => setShowGreeting(!showGreeting)}
                                        className={`w-12 h-6 rounded-full p-1 transition-colors ${showGreeting ? 'bg-hikari-accent' : 'bg-gray-300'}`}
                                    >
                                        <div className={`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform ${showGreeting ? 'translate-x-6' : 'translate-x-0'}`} />
                                    </button>
                                </div>

                                <div className="space-y-4 pt-2 border-t border-gray-100 dark:border-gray-700">
                                    <h4 className="font-bold text-sm flex items-center gap-2 text-hikari-accent">
                                        <Calendar size={16} /> ä¼šç¤¾ä¼‘æ—¥ãƒ»è¡Œäº‹è¨­å®š
                                    </h4>
                                    
                                    <div className="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg space-y-3">
                                        <div className="flex items-center gap-2 mb-1">
                                            <Building size={16} className="text-gray-500" />
                                            <span className="text-xs font-bold">æœ¬ç¤¾ ä¼‘æš‡è¨­å®š</span>
                                        </div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">å¤å­£ä¼‘æš‡ é–‹å§‹</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.hq.summer.start}
                                                    onChange={(e) => handleHolidayChange('hq', 'summer', 'start', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">çµ‚äº†</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.hq.summer.end}
                                                    onChange={(e) => handleHolidayChange('hq', 'summer', 'end', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">å†¬å­£ä¼‘æš‡ é–‹å§‹</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.hq.winter.start}
                                                    onChange={(e) => handleHolidayChange('hq', 'winter', 'start', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">çµ‚äº†</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.hq.winter.end}
                                                    onChange={(e) => handleHolidayChange('hq', 'winter', 'end', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-gray-50 dark:bg-gray-800 p-3 rounded-lg space-y-3">
                                        <div className="flex items-center gap-2 mb-1">
                                            <Factory size={16} className="text-gray-500" />
                                            <span className="text-xs font-bold">å·¥å ´ ä¼‘æš‡è¨­å®š</span>
                                        </div>
                                        <div className="grid grid-cols-2 gap-2">
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">å¤å­£ä¼‘æš‡ é–‹å§‹</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.factory.summer.start}
                                                    onChange={(e) => handleHolidayChange('factory', 'summer', 'start', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">çµ‚äº†</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.factory.summer.end}
                                                    onChange={(e) => handleHolidayChange('factory', 'summer', 'end', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">å†¬å­£ä¼‘æš‡ é–‹å§‹</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.factory.winter.start}
                                                    onChange={(e) => handleHolidayChange('factory', 'winter', 'start', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                            <div>
                                                <label className="text-[10px] font-bold block mb-1">çµ‚äº†</label>
                                                <input 
                                                    type="date" 
                                                    value={holidaySettings.factory.winter.end}
                                                    onChange={(e) => handleHolidayChange('factory', 'winter', 'end', e.target.value)}
                                                    className="w-full p-1 text-xs border rounded dark:bg-gray-700 dark:border-gray-600"
                                                />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Link Settings */}
                                <div className="space-y-3 pt-2 border-t border-gray-100 dark:border-gray-700">
                                    <h4 className="font-bold text-sm flex items-center gap-2 text-hikari-accent">
                                        <Link size={16} /> ãƒªãƒ³ã‚¯è¨­å®š
                                    </h4>
                                    <div>
                                        <label className="text-[10px] font-bold block mb-1">ãƒªãƒ³ã‚¯å…ˆã®URL (ãŠå®¢æ§˜ã®URL)</label>
                                        <input 
                                            type="text" 
                                            value={customLinkUrl}
                                            onChange={(e) => setCustomLinkUrl(e.target.value)}
                                            className="w-full p-2 border bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-1 focus:ring-hikari-accent outline-none"
                                            placeholder="https://..."
                                        />
                                    </div>
                                    <div>
                                        <label className="text-[10px] font-bold block mb-1">è¡¨ç¤ºã•ã›ã‚‹URL (æŠ•ç¨¿ç”¨ãƒ†ã‚­ã‚¹ãƒˆ)</label>
                                        <input 
                                            type="text" 
                                            value={customLinkText}
                                            onChange={(e) => setCustomLinkText(e.target.value)}
                                            className="w-full p-2 border bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-1 focus:ring-hikari-accent outline-none"
                                            placeholder="ä¾‹ï¼šè©³ã—ãã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®ãƒªãƒ³ã‚¯ã¸"
                                        />
                                        <p className="text-[10px] opacity-60 mt-1">â€»Instagramã®æŠ•ç¨¿æ–‡æœ«å°¾ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
                                    </div>
                                </div>

                                <div className="space-y-2 pt-2 border-t border-gray-100 dark:border-gray-700">
                                    <label className="font-bold text-sm block">ç½²åï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ï¼‰ã®ç·¨é›†</label>
                                    <textarea 
                                        value={signature}
                                        onChange={(e) => setSignature(e.target.value)}
                                        className="w-full p-3 border bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg text-sm h-24 resize-none focus:ring-1 focus:ring-hikari-accent outline-none"
                                    />
                                    <p className="text-xs opacity-60">â€»FacebookæŠ•ç¨¿ã®æœ«å°¾ã«æŒ¿å…¥ã•ã‚Œã¾ã™</p>
                                </div>

                                <div className="space-y-2">
                                    <label className="font-bold text-sm block">ç°¡æ˜“NGãƒ¯ãƒ¼ãƒ‰ç™»éŒ²</label>
                                    <input 
                                        type="text"
                                        value={ngWordsStr}
                                        onChange={(e) => setNgWordsStr(e.target.value)}
                                        className="w-full p-3 border bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:ring-1 focus:ring-hikari-accent outline-none"
                                        placeholder="ã‚«ãƒ³ãƒ(,)åŒºåˆ‡ã‚Šã§å…¥åŠ›"
                                    />
                                    <p className="text-xs opacity-60">å…¥åŠ›å†…å®¹ã«å«ã¾ã‚Œã‚‹ã¨è­¦å‘Šã‚’è¡¨ç¤ºã—ã¾ã™</p>
                                </div>

                            </div>
                            <div className="p-4 bg-gray-50 dark:bg-gray-800 text-center border-t border-gray-100 dark:border-gray-700">
                                <button onClick={() => setIsSettingsOpen(false)} className="px-8 py-2 bg-gray-800 dark:bg-gray-600 text-white rounded-lg font-bold hover:bg-gray-700">é–‰ã˜ã‚‹</button>
                            </div>
                        </div>
                    </div>
                )}
                
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<HikariBrandNote />);
    </script>
</body>
</html>